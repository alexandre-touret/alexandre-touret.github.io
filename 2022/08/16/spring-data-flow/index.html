<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Déployer des batchs cloud native avec Spring Cloud Data Flow - Alexandre Touret's Blog</title><meta name=Description content="Alexandre Touret's Blog"><meta property="og:url" content="https://blog.touret.info/2022/08/16/spring-data-flow/">
<meta property="og:site_name" content="Alexandre Touret's Blog"><meta property="og:title" content="Déployer des batchs cloud native avec Spring Cloud Data Flow"><meta property="og:description" content="Dans mon dernier article, j’ai tenté de faire un état des lieux des solutions possibles pour implémenter des batchs cloud natifs.
J’ai par la suite testé plus en détails les jobs et cron jobs Kubernetes en essayant d’avoir une vue OPS sur ce sujet. Le principal inconvénient (qui ne l’est pas dans certains cas) des jobs est qu’on ne peut pas les rejouer. Si ces derniers sont terminés avec succès - Vous allez me dire, il faut bien les coder - mais qu’on souhaite les rejouer pour diverses raisons, on doit les supprimer et relancer."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-16T08:00:00+00:00"><meta property="article:modified_time" content="2023-03-08T11:09:07+01:00"><meta property="article:tag" content="Cloud"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Batch"><meta property="article:tag" content="Spring"><meta property="og:image" content="https://blog.touret.info/assets/images/2022/08/maksym-tymchyk-vHO-yT1BDWk-unsplash.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.touret.info/assets/images/2022/08/maksym-tymchyk-vHO-yT1BDWk-unsplash.webp"><meta name=twitter:title content="Déployer des batchs cloud native avec Spring Cloud Data Flow"><meta name=twitter:description content="Dans mon dernier article, j’ai tenté de faire un état des lieux des solutions possibles pour implémenter des batchs cloud natifs.
J’ai par la suite testé plus en détails les jobs et cron jobs Kubernetes en essayant d’avoir une vue OPS sur ce sujet. Le principal inconvénient (qui ne l’est pas dans certains cas) des jobs est qu’on ne peut pas les rejouer. Si ces derniers sont terminés avec succès - Vous allez me dire, il faut bien les coder - mais qu’on souhaite les rejouer pour diverses raisons, on doit les supprimer et relancer."><meta name=twitter:site content="@touret_alex"><meta name=application-name content="Alexandre Touret's Blog"><meta name=apple-mobile-web-app-title content="Alexandre Touret's Blog"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><meta name=twitter:creator content="@touret_alex"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://blog.touret.info/2022/08/16/spring-data-flow/><link rel=prev href=https://blog.touret.info/2022/06/10/camping-speakers-2022/><link rel=next href=https://blog.touret.info/2022/10/15/devoxx-be-22/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="7UnqNmvO-mjfMkRqKaaWRPTBxSylEVJXvAn8iTfc7SI"><meta name=msvalidate.01 content="F9655A4C8648E42154ECB4B4D6CF60A2"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Déployer des batchs cloud native avec Spring Cloud Data Flow","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.touret.info/2022/08/16/spring-data-flow/"},"image":["https://blog.touret.info/images/alexandre.touret.webp"],"genre":"posts","keywords":"cloud, kubernetes, batch, spring","wordcount":1174,"url":"https://blog.touret.info/2022/08/16/spring-data-flow/","datePublished":"2022-08-16T08:00:00+00:00","dateModified":"2023-03-08T11:09:07+01:00","license":"This work is licensed under a Creative Commons Attribution 4.0 International License.","publisher":{"@type":"Organization","name":"Alexandre Touret","logo":"https://blog.touret.info/images/alexandre.touret.webp"},"author":{"@type":"Person","name":"Alexandre Touret"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Alexandre Touret's Blog"><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/contact/>Contact </a><a class=menu-item href=/talks/>Talks </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i>
</span></span><a href=javascript:void(0); class="menu-item theme-select" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-desktop title="Switch Theme"><option value=light>Light</option><option value=dark>Dark</option><option value=black>Black</option><option value=auto>Auto</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Alexandre Touret's Blog"><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/contact/ title>Contact</a><a class=menu-item href=/talks/ title>Talks</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-select" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-mobile title="Switch Theme"><option value=light>Light</option><option value=dark>Dark</option><option value=black>Black</option><option value=auto>Auto</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#installation-et-configuration-de-minikube>Installation et configuration de Minikube</a><ul><li><a href=#installation-de-spring-cloud-data-flow>Installation de Spring Cloud Data Flow</a></li><li><a href=#accès-au-dashboard>Accès au dashboard</a></li></ul></li><li><a href=#développement-dune-task>Développement d&rsquo;une Task</a><ul><li><a href=#initialisation>Initialisation</a></li><li><a href=#construction-de-la-tâche>Construction de la tâche</a></li><li><a href=#packaging>Packaging</a></li></ul></li><li><a href=#déploiement>Déploiement</a><ul><li><a href=#création-et-déploiement-de-limage-docker>Création et déploiement de l&rsquo;image Docker</a></li><li><a href=#création-de-lapplication>Création de l&rsquo;application</a></li><li><a href=#création-de-la-tâche>Création de la tâche</a></li></ul></li><li><a href=#exécution>Exécution</a></li><li><a href=#aller-plus-loin>Aller plus loin</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Déployer des batchs cloud native avec Spring Cloud Data Flow</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=https://blog.touret.info title=Author target=_blank rel="noopener noreferrer author" class=author>Alexandre Touret</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-08-16>2022-08-16</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2023-03-08>2023-03-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1174 words&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#installation-et-configuration-de-minikube>Installation et configuration de Minikube</a><ul><li><a href=#installation-de-spring-cloud-data-flow>Installation de Spring Cloud Data Flow</a></li><li><a href=#accès-au-dashboard>Accès au dashboard</a></li></ul></li><li><a href=#développement-dune-task>Développement d&rsquo;une Task</a><ul><li><a href=#initialisation>Initialisation</a></li><li><a href=#construction-de-la-tâche>Construction de la tâche</a></li><li><a href=#packaging>Packaging</a></li></ul></li><li><a href=#déploiement>Déploiement</a><ul><li><a href=#création-et-déploiement-de-limage-docker>Création et déploiement de l&rsquo;image Docker</a></li><li><a href=#création-de-lapplication>Création de l&rsquo;application</a></li><li><a href=#création-de-la-tâche>Création de la tâche</a></li></ul></li><li><a href=#exécution>Exécution</a></li><li><a href=#aller-plus-loin>Aller plus loin</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fwnote"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>This article was last updated on <span class=timeago datetime=2023-03-08T11:09:07 title="March 8, 2023">2023-03-08</span>, the content may be out of date.</div></div></div><p><a href=https://blog.touret.info/2022/05/17/cloud-native-batchs/ target=_blank rel="noopener noreferrer">Dans mon dernier article</a>, j&rsquo;ai tenté de faire un état des lieux des solutions possibles pour implémenter des batchs cloud natifs.</p><div id=id-1><figure><img loading=lazy src=/assets/images/2022/08/maksym-tymchyk-vHO-yT1BDWk-unsplash.webp srcset="/assets/images/2022/08/maksym-tymchyk-vHO-yT1BDWk-unsplash.webp, /assets/images/2022/08/maksym-tymchyk-vHO-yT1BDWk-unsplash.webp 1.5x, /assets/images/2022/08/maksym-tymchyk-vHO-yT1BDWk-unsplash.webp 2x" title=dataflow></figure></div><p>J&rsquo;ai par la suite testé plus en détails les <a href=https://kubernetes.io/docs/concepts/workloads/controllers/job/ target=_blank rel="noopener noreferrer">jobs</a> et <a href=https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/ target=_blank rel="noopener noreferrer">cron jobs</a> Kubernetes en essayant d&rsquo;avoir une vue OPS sur ce sujet.
Le principal inconvénient (qui ne l&rsquo;est pas dans certains cas) des jobs est qu&rsquo;on ne peut pas les rejouer.
Si ces derniers sont terminés avec succès - <em>Vous allez me dire, il faut bien les coder</em> - mais qu&rsquo;on souhaite les rejouer pour diverses raisons, on doit les supprimer et relancer.
J&rsquo;ai vu plusieurs posts sur StackOverflow à ce sujet, je n&rsquo;ai pas trouvé de solutions satisfaisantes relatifs à ce sujet.</p><div id=id-2><figure><img loading=lazy src=/assets/images/2022/08/luke_cage.webp srcset="/assets/images/2022/08/luke_cage.webp, /assets/images/2022/08/luke_cage.webp 1.5x, /assets/images/2022/08/luke_cage.webp 2x" title=dataflow></figure></div><p>Attention, je ne dis pas que les jobs et cron jobs ne doivent pas être utilisés.
Loin de là.</p><p>Je pense que si vous avez besoin d&rsquo;un traitement sans chaînage d&rsquo;actions, sans rejeu, les <a href=https://kubernetes.io/docs/concepts/workloads/controllers/job/ target=_blank rel="noopener noreferrer">jobs</a> et <a href=https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/ target=_blank rel="noopener noreferrer">cron jobs</a> sont de bonnes options.
Le monitoring et reporting des actions réalisées peut se faire par l&rsquo;observabilité mise en place dans votre cluster K8S.</p><div id=id-3><figure><img loading=lazy src=/assets/images/2022/08/spring_dataflow_logo.webp srcset="/assets/images/2022/08/spring_dataflow_logo.webp, /assets/images/2022/08/spring_dataflow_logo.webp 1.5x, /assets/images/2022/08/spring_dataflow_logo.webp 2x" title=dataflow></figure></div><p>Après plusieurs recherches, je suis tombé sur <a href=https://dataflow.spring.io/ target=_blank rel="noopener noreferrer">Spring Data Flow</a>.
L&rsquo;offre de ce module de Spring Cloud va au delà des batchs.
Il permet notamment de gérer le streaming via une interface graphique ou via son <a href=https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/#api-guide target=_blank rel="noopener noreferrer">API</a>.</p><p>Dans cet article, je vais implémenter un exemple et le déployer dans <a href=https://minikube.sigs.k8s.io/ target=_blank rel="noopener noreferrer">Minikube</a>.</p><h2 id=installation-et-configuration-de-minikube class=headerLink><a href=#installation-et-configuration-de-minikube class=header-mark></a>1 Installation et configuration de Minikube</h2><p>L&rsquo;installation de minikube est décrite sur <a href=https://minikube.sigs.k8s.io/docs/start/ target=_blank rel="noopener noreferrer">le site officiel</a>.</p><p>Pour l&rsquo;installer, j&rsquo;ai exécuté les commandes suivantes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
</span></span><span class=line><span class=cl>sudo install minikube-linux-amd64 /usr/local/bin/minikube
</span></span></code></pre></td></tr></table></div></div><p>Au premier démarrage, vous finirez l&rsquo;installation</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>minikube start
</span></span></code></pre></td></tr></table></div></div><h3 id=installation-de-spring-cloud-data-flow class=headerLink><a href=#installation-de-spring-cloud-data-flow class=header-mark></a>1.1 Installation de Spring Cloud Data Flow</h3><p>Pour installer Spring Cloud Data Flow directement dans Kubernetes, vous pouvez exécuter les commandes suivantes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add bitnami https://charts.bitnami.com/bitnami
</span></span><span class=line><span class=cl>helm install my-release bitnami/spring-cloud-dataflow
</span></span></code></pre></td></tr></table></div></div><p>Après quelques minutes de téléchargement, vous devriez avoir le retour suivante à l&rsquo;exécution de la commande <code>kubectl get pods</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>~ » kubectl get pods                                                                           
</span></span><span class=line><span class=cl>NAME  READY   STATUS             RESTARTS      AGE
</span></span><span class=line><span class=cl>dataflow-mariadb-0  1/1     Running            <span class=m>1</span> <span class=o>(</span>24h ago<span class=o>)</span>   24h
</span></span><span class=line><span class=cl>dataflow-rabbitmq-0 1/1     Running            <span class=m>1</span> <span class=o>(</span>24h ago<span class=o>)</span>   24h
</span></span><span class=line><span class=cl>dataflow-spring-cloud-dataflow-server-75db59d6cb-lrwp8   1/1 Running            <span class=m>1</span> <span class=o>(</span>24h ago<span class=o>)</span>   24h
</span></span><span class=line><span class=cl>dataflow-spring-cloud-dataflow-skipper-9db568cf4-rzsqq   1/1     Running            <span class=m>1</span> <span class=o>(</span>24h ago<span class=o>)</span>   24h
</span></span></code></pre></td></tr></table></div></div><h3 id=accès-au-dashboard class=headerLink><a href=#acc%c3%a8s-au-dashboard class=header-mark></a>1.2 Accès au dashboard</h3><p>Pour accéder au <a href=https://cloud.spring.io/spring-cloud-dataflow-ui/ target=_blank rel="noopener noreferrer">dashboard de Spring Cloud Data Flow</a>, vous pouvez lancer les commandes suivantes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SERVICE_PORT</span><span class=o>=</span><span class=k>$(</span>kubectl get --namespace default -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&#34;{.spec.ports[0].port}&#34;</span> services dataflow-spring-cloud-dataflow-server<span class=k>)</span>
</span></span><span class=line><span class=cl>kubectl port-forward --namespace default svc/dataflow-spring-cloud-dataflow-server <span class=si>${</span><span class=nv>SERVICE_PORT</span><span class=si>}</span>:<span class=si>${</span><span class=nv>SERVICE_PORT</span><span class=si>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Ensuite, vous pourrez accéder à la console web via l&rsquo;URL <code>http://localhost:8080/dashboard</code>.</p><h2 id=développement-dune-task class=headerLink><a href=#d%c3%a9veloppement-dune-task class=header-mark></a>2 Développement d&rsquo;une Task</h2><p>J&rsquo;ai crée une simple task qui va rechercher la nationalité d&rsquo;un prénom.
Pour ceci, j&rsquo;utilise l&rsquo;API <a href=https://api.nationalize.io/ target=_blank rel="noopener noreferrer">https://api.nationalize.io/</a>.</p><p>On passe un prénom en paramètre et on obtient une liste de nationalités possibles avec leurs probabilités.</p><p>Vous trouverez les sources de cet exemple sur <a href=https://github.com/alexandre-touret/cloud-task target=_blank rel="noopener noreferrer">mon Github</a>.</p><p>Aussi, la documentation est bien faite, il suffit de <a href=https://dataflow.spring.io/docs/batch-developer-guides/batch/spring-task/ target=_blank rel="noopener noreferrer">la lire</a>.</p><h3 id=initialisation class=headerLink><a href=#initialisation class=header-mark></a>2.1 Initialisation</h3><p>J&rsquo;ai initié un projet Spring avec les dépendances suivantes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;org.springframework.boot:spring-boot-starter-web&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;org.springframework.cloud:spring-cloud-starter-task&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>developmentOnly</span> <span class=s1>&#39;org.springframework.boot:spring-boot-devtools&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>testImplementation</span> <span class=s1>&#39;org.springframework.boot:spring-boot-starter-test&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;org.springframework.boot:spring-boot-starter-jdbc&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>runtimeOnly</span> <span class=s1>&#39;org.mariadb.jdbc:mariadb-java-client&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dependencyManagement</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>imports</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>mavenBom</span> <span class=s2>&#34;org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Attention, les starters et dépendances JDBC/MariaDB sont indispensables pour que votre tâche puisse enregistrer le statut des exécutions.</p><h3 id=construction-de-la-tâche class=headerLink><a href=#construction-de-la-t%c3%a2che class=header-mark></a>2.2 Construction de la tâche</h3><p>Une tâche se crée facilement en annotation une classe &ldquo;Configuration&rdquo; par l&rsquo;annotation <code>@EnableTask</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableTask</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>TaskConfiguration</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Ensuite l&rsquo;essentiel du job s&rsquo;effectue dans la construction d&rsquo;un bean <code>CommandLineRunner</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>CommandLineRunner</span><span class=w> </span><span class=nf>createCommandLineRunner</span><span class=p>(</span><span class=n>RestTemplate</span><span class=w> </span><span class=n>restTemplate</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>args</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>var</span><span class=w> </span><span class=n>commandLinePropertySource</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SimpleCommandLinePropertySource</span><span class=p>(</span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>var</span><span class=w> </span><span class=n>entity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>restTemplate</span><span class=p>.</span><span class=na>getForEntity</span><span class=p>(</span><span class=s>&#34;https://api.nationalize.io/?name=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>Optional</span><span class=p>.</span><span class=na>ofNullable</span><span class=p>(</span><span class=n>commandLinePropertySource</span><span class=p>.</span><span class=na>getProperty</span><span class=p>(</span><span class=s>&#34;name&#34;</span><span class=p>)).</span><span class=na>orElse</span><span class=p>(</span><span class=s>&#34;BLANK&#34;</span><span class=p>),</span><span class=w> </span><span class=n>NationalizeResponseDTO</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>LOGGER</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;RESPONSE[{}]: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>entity</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>(),</span><span class=w> </span><span class=n>entity</span><span class=p>.</span><span class=na>getBody</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Dans mon exemple, j&rsquo;affiche dans la sortie standard le payload de l&rsquo;API ainsi que le code HTTP de la réponse.</p><p>Voici un exemple d&rsquo;exécution :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>2022-08-12 15:11:07.885  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port<span class=o>(</span>s<span class=o>)</span>: <span class=m>8080</span> <span class=o>(</span>http<span class=o>)</span> with context path <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>2022-08-12 15:11:07.894  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> i.t.b.cloudtask.CloudTaskApplication     : Started CloudTaskApplication in 17.704 seconds <span class=o>(</span>JVM running <span class=k>for</span> 19.18<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-08-12 15:11:10.722  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> i.t.batch.cloudtask.TaskConfiguration    : RESPONSE<span class=o>[</span><span class=m>200</span> OK<span class=o>]</span>: NationalizeResponseDTO<span class=o>{</span><span class=nv>name</span><span class=o>=</span><span class=s1>&#39;Alexandre&#39;</span>, <span class=nv>countries</span><span class=o>=[</span>CountryDTO<span class=o>{</span><span class=nv>countryId</span><span class=o>=</span><span class=s1>&#39;BR&#39;</span>, pr....
</span></span></code></pre></td></tr></table></div></div><h3 id=packaging class=headerLink><a href=#packaging class=header-mark></a>2.3 Packaging</h3><p>Ici rien de nouveau, il suffit de lancer la commande:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./gradlew build
</span></span></code></pre></td></tr></table></div></div><h2 id=déploiement class=headerLink><a href=#d%c3%a9ploiement class=header-mark></a>3 Déploiement</h2><h3 id=création-et-déploiement-de-limage-docker class=headerLink><a href=#cr%c3%a9ation-et-d%c3%a9ploiement-de-limage-docker class=header-mark></a>3.1 Création et déploiement de l&rsquo;image Docker</h3><p>Pour déployer notre toute nouvelle tâche, nous allons d&rsquo;abord créer l&rsquo;image Docker avec buildpack.</p><p>Tout d&rsquo;abord on va se brancher sur minikube pour que notre image soit déployée dans le repository de minikube</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>eval</span> <span class=k>$(</span>minikube docker-env<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Ensuite, il nous reste à créer l&rsquo;image Docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./gradlew bootBuildImage --imageName<span class=o>=</span>info.touret/cloud-task:latest
</span></span></code></pre></td></tr></table></div></div><p>Pour vérifier que votre image est bien présente dans minikube, vous pouvez exécuter la commande suivante:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>minikube image ls <span class=p>|</span> grep cloud-task                                                                                                                                                                          
</span></span><span class=line><span class=cl>info.touret/cloud-task:latest
</span></span></code></pre></td></tr></table></div></div><h3 id=création-de-lapplication class=headerLink><a href=#cr%c3%a9ation-de-lapplication class=header-mark></a>3.2 Création de l&rsquo;application</h3><p>Avant de créer la tâche dans l&rsquo;interface, il faut d&rsquo;abord référencer l&rsquo;image Docker en créer une <a href=https://dataflow.spring.io/docs/applications/ target=_blank rel="noopener noreferrer">application</a>:</p><figure><img src=/assets/images/2022/08/dataflow_config5.webp></figure><p>Il faut déclarer l&rsquo;image Docker avec le formalisme présenté dans la capture d&rsquo;écran.</p><h3 id=création-de-la-tâche class=headerLink><a href=#cr%c3%a9ation-de-la-t%c3%a2che class=header-mark></a>3.3 Création de la tâche</h3><p>Voici les différentes actions que j&rsquo;ai réalisé via l&rsquo;interface:</p><p><div class=gallery-wrapper style=grid-template-columns:repeat(2,1fr)><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config3.webp srcset="/assets/images/2022/08/dataflow_config3.webp, /assets/images/2022/08/dataflow_config3.webp 1.5x, /assets/images/2022/08/dataflow_config3.webp 2x" title=configuration></figure></div><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config4.webp srcset="/assets/images/2022/08/dataflow_config4.webp, /assets/images/2022/08/dataflow_config4.webp 1.5x, /assets/images/2022/08/dataflow_config4.webp 2x" title=configuration></figure></div></div>Vous trouverez plus de détails dans <a href=https://dataflow.spring.io/docs/batch-developer-guides/batch/data-flow-simple-task/ target=_blank rel="noopener noreferrer">la documentation officielle</a>.</p><h2 id=exécution class=headerLink><a href=#ex%c3%a9cution class=header-mark></a>4 Exécution</h2><p>Maintenant, il nous est possible de lancer notre tâche.
Vous trouverez dans les copies d&rsquo;écran ci-dessous les différentes actions que j&rsquo;ai réalisé pour exécuter ma toute nouvelle tâche.</p><div class=gallery-wrapper style=grid-template-columns:repeat(2,1fr)><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config2.webp srcset="/assets/images/2022/08/dataflow_config2.webp, /assets/images/2022/08/dataflow_config2.webp 1.5x, /assets/images/2022/08/dataflow_config2.webp 2x" title=configuration></figure></div><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config10.webp srcset="/assets/images/2022/08/dataflow_config10.webp, /assets/images/2022/08/dataflow_config10.webp 1.5x, /assets/images/2022/08/dataflow_config10.webp 2x" title=configuration></figure></div><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config8.webp srcset="/assets/images/2022/08/dataflow_config8.webp, /assets/images/2022/08/dataflow_config8.webp 1.5x, /assets/images/2022/08/dataflow_config8.webp 2x" title=configuration></figure></div><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config7.webp srcset="/assets/images/2022/08/dataflow_config7.webp, /assets/images/2022/08/dataflow_config7.webp 1.5x, /assets/images/2022/08/dataflow_config7.webp 2x" title=configuration></figure></div><div class=img-wrapper><figure><img loading=lazy src=/assets/images/2022/08/dataflow_config9.webp srcset="/assets/images/2022/08/dataflow_config9.webp, /assets/images/2022/08/dataflow_config9.webp 1.5x, /assets/images/2022/08/dataflow_config9.webp 2x" title=configuration></figure></div></div><p>J&rsquo;ai pu également accéder aux logs.</p><p>Il est également important de noter qu&rsquo; après l&rsquo;exécution d&rsquo;une tâche, le POD est toujours au statut <code>RUNNING</code> afin que Kubernetes ne redémarre pas automatiquement le traitement.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods <span class=p>|</span> grep cloud-task                                                                                                                                                                           
</span></span><span class=line><span class=cl>cloud-task-7mp72gzpwo                                    1/1     Running            <span class=m>0</span>               57m
</span></span><span class=line><span class=cl>cloud-task-pymdkr182p                                    1/1     Running            <span class=m>0</span>               65m
</span></span></code></pre></td></tr></table></div></div><p>A chaque exécution il y aura donc un pod d&rsquo;alloué.</p><h2 id=aller-plus-loin class=headerLink><a href=#aller-plus-loin class=header-mark></a>5 Aller plus loin</h2><p>Parmi les fonctionnalités que j&rsquo;ai découvert, on peut :</p><ul><li>relancer un traitement</li><li>le programmer</li><li>nettoyer les exécutions</li><li>les pistes d&rsquo;audit</li><li>le chaînage des différentes tâches</li></ul><p>Gros inconvénient pour le nettoyage: je n&rsquo;ai pas constaté un impact dans les pods alloués.</p><h2 id=conclusion class=headerLink><a href=#conclusion class=header-mark></a>6 Conclusion</h2><p>Pour résumer, je vais me risquer à comparer les deux solutions jobs/cron jobs Kubernetes et une solution basée sur Spring Cloud Dataflow.
Je vais donc utiliser la liste des caractéristiques présentée par <a href=https://fundamentalsofsoftwarearchitecture.com/ target=_blank rel="noopener noreferrer">M. Richards et N. Ford dans leur livre: Fundamentals of Software Architecture</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>Bien évidemment, cette notation est purement personnelle.
Vous noterez que selon où on positionne le curseur, l&rsquo;une des deux solutions peut s&rsquo;avérer meilleure (ou pas).</p><p>Bref, tout dépend de vos contraintes et de ce que vous souhaitez en faire.
A mon avis, une solution telle que Spring Cloud Dataflow s&rsquo;inscrit parfaitement pour des traitements mixtes (streaming, batch) et pour des traitements Big Data.</p><p>N&rsquo;hésitez pas à me donner votre avis (<a href=https://blog.touret.info/a-propos/ target=_blank rel="noopener noreferrer">sans troller svp</a>) en commentaire ou si ça concerne l&rsquo;exemple, directement <a href=https://github.com/alexandre-touret/cloud-task target=_blank rel="noopener noreferrer">dans Github</a>.</p><table><thead><tr><th>Architecture characteristic</th><th>K8s job rating</th><th>Spring Cloud Dataflow rating</th></tr></thead><tbody><tr><td>Partitioning type</td><td>Domain & technical</td><td>Domain & technical</td></tr><tr><td>Number of quanta <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></td><td>1</td><td>1 to many</td></tr><tr><td>Deployability</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr><tr><td>Elasticity</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr><tr><td>Evolutionary</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr><tr><td>Fault Tolerance</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr><tr><td>Modularity</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐⭐</td></tr><tr><td>Overall cost</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td>Performance</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td>Reliability</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td>Scalability</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr><tr><td>Simplicity</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td>Testability</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr></tbody></table><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A lire absolument!&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>~ Nombre de livrables indépendants fortement couplés&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-03-08&nbsp;<a class=git-hash href=https://github.com/alexandre-touret/alexandre-touret.github.io/commit/b8738e3449b0463f22b214fb0ea7663ffef33a8a target=_blank title="commit by Alexandre Touret(943841+alexandre-touret@users.noreply.github.com) b8738e3449b0463f22b214fb0ea7663ffef33a8a: Fix links too close (#76)" rel="noopener noreferrer">
<i class="fas fa-hashtag fa-fw"></i>b8738e3</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-mardown href=/2022/08/16/spring-data-flow/index.md target=_blank rel="noopener noreferrer">Read markdown</a>
</span><span>|&nbsp;<a class=link-to-source href=https://github.com/alexandre-touret/alexandre-touret.github.io/blob/main/exampleSite/content/posts/spring-data-flow.md target=_blank rel="noopener noreferrer">View source</a>
</span><span>|&nbsp;<a class=link-to-report href="https://github.com/alexandre-touret/alexandre-touret.github.io/issues/new?title=[bug]%20D%C3%A9ployer+des+batchs+cloud+native+avec+Spring+Cloud+Data+Flow&body=|Field|Value|%0A|-|-|%0A|Title|D%C3%A9ployer+des+batchs+cloud+native+avec+Spring+Cloud+Data+Flow|%0A|Url|https://blog.touret.info/2022/08/16/spring-data-flow/|%0A|Filename|https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts/spring-data-flow.md|" target=_blank rel="noopener noreferrer">Report issue</a></span></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/cloud/>Cloud</a>,&nbsp;<a href=/tags/kubernetes/>Kubernetes</a>,&nbsp;<a href=/tags/batch/>Batch</a>,&nbsp;<a href=/tags/spring/>Spring</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/06/10/camping-speakers-2022/ class=prev rel=prev title="Mon Camping des Speakers"><i class="fas fa-angle-left fa-fw"></i>Mon Camping des Speakers</a>
<a href=/2022/10/15/devoxx-be-22/ class=next rel=next title="Ma première participation à Devoxx Belgium">Ma première participation à Devoxx Belgium<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.126.1">Hugo</a>&nbsp;|&nbsp;Theme - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2018 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://blog.touret.info target=_blank rel="noopener noreferrer">Alexandre Touret</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by/4.0/ target=_blank>CC BY 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"",lightTheme:"github-light",repo:"alexandre-touret/alexandre-touret.github.io"}},data:{"desktop-header-typeit":"blog.touret.info","mobile-header-typeit":"blog.touret.info"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!0,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"No results found",snippetLength:300,threshold:.1,type:"fuse",useExtendedSearch:!1},table:{sort:!0},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:-1,speed:100}}</script><script type=text/javascript src=/lib/tablesort/tablesort.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript src=/js/utterances.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F1EK89MHJD",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-F1EK89MHJD" async></script></div></body></html>